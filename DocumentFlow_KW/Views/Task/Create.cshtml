
@model DocumentFlow_KW.ViewModels.TaskUsers
@{
    ViewBag.Title = "Создание документа";
}

<link href="~/lib/select2/css/select2.min.css" rel="stylesheet" />
<!-- select2-bootstrap4-theme -->
<link href="https://raw.githack.com/ttskch/select2-bootstrap5-theme/master/dist/select2-bootstrap4.css" rel="stylesheet">

<div class="mx-auto" style="padding: 3%">
    <h1 class="h3 mb-3 fw-normal">Создать задачу</h1>
    <form asp-action="Create" asp-controller="Task">
        <div asp-validation-summary="All" class="text-danger"></div>
        <div class="form-group">
            <label asp-for="Task.Topic" class="control-label, font-weight-bold">Тема</label>
            <input type="text" asp-for="Task.Topic" class="form-control" />
        </div>

        <div class="form-group">
            <label asp-for="Task.Executor" class="control-label, font-weight-bold">Исполнитель </label>
            <select asp-for="Task.Executor" class="form-select">
                <option selected>@Model.Task.Fio </option>
                @{ int i = 1;
                    @foreach (var user in Model.FioUsers)
                    {
                        if (Equals(user.Fio + " (" + user.Position + ")", Model.Task.Fio) == true)
                        {
                            continue;
                        }
                        <option>@user.Fio (@user.Position)</option>
                        //<option>@user.Fio</option>
                        i++;
                    }
                }
            </select>
            @*<input type="text" asp-for="Executor" class="form-control" />*@

        </div>
        @*<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <link href = "https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/css/select2.min.css" rel = "stylesheet"/>
        <script src = "https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/js/select2.min.js"></script>*@
       @* <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
        <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>*@
        @*<script>
            $(document).ready(function(){
                $("#executor").select2({

                });
            });
        </script>*@

            @*<label asp-for="Task.Executor" class="control-label, font-weight-bold" style = "width = 250px">Исполнитель </label>*@
            @*<select asp-for="Task.Executor" name="executor" class = "statesSelect" id="executor" style = "width = 250px">
	        @*<option value="" selected hidden></option>*@
            @*<option></option>*@
            @*<option data-select2-id = "0">@Model.Task.Fio</option>
	        @{ int i = 1;
                    @foreach (var user in Model.FioUsers)
                    {
                        if (Equals(user.Fio + " (" + user.Position + ")", Model.Task.Fio) == true)
                        {
                            continue;
                        }
                        <option data-select2-id = '@i+1'>@user.Fio (@user.Position)</option>
                        //<option>@user.Fio</option>
                        i++;
                    }
                }
        </select>*@
       @*@Model.Task.Executor = o*@
 
        @*<link rel="stylesheet" href="/select2/dist/css/select2.min.css">
        <script src="/jquery.min.js"></script>
        <script src="/select2/dist/js/select2.min.js"></script>
        <script src="/select2/dist/js/i18n/ru.js"></script>
 
        <script>
        $(document).ready(function() {
	        $('.js-select2').select2({
		        placeholder: "Выберите исполнителя",
		        maximumSelectionLength: 7,
		        language: "ru"
	        });
        });
        </script>*@

        <div class="form-group">
            <label asp-for="Task.EndDate" class="control-label font-weight-bold">Срок выполнения до</label>
            <input type="datetime-local" asp-for="Task.EndDate" class="form-control" style="width: 210px;" />
        </div>
        <div class="form-group">
            <label asp-for="Task.Priority" class="control-label font-weight-bold">Приоритет<br /></label>
            <select asp-for="Task.Priority" class="form-select" id="floatingSelect">
                <option selected>Низкий</option>
                <option>Средний</option>
                <option>Высокий</option>
            </select>
        </div>
        <div class="form-group">
            <label asp-for="Task.Type" class="control-label font-weight-bold">Категория</label>
            <select asp-for="Task.Type" class="form-select" id="floatingSelect">
                <option selected>Обычная</option>
                <option>Влияющая на зарплату</option>
            </select>
        </div>
        <div class="form-group">
            <label asp-for="Task.Description" class="control-label font-weight-bold">Описание</label>
            <textarea type="text" asp-for="Task.Description" class="form-control" rows="3" style="height: 100px;"></textarea>
            @*<input type="text" asp-for="Documents.Description" class="form-control" style="height: 100px;" />*@
        </div>
        <div class="form-group">
            <input type="submit" value="Создать" class="btn btn-success" onclick='if (Document.Topic.value=="" || Document.EndDate.value=="") {alert("Заполните обязательные поля")} else {form.submit()}' />
        </div>
    </form>

</div>
@*@section Scripts
{
    <script src="~/lib/select2/js/select2.full.min.js"></script>
    <script src="~/js/select2.js"></script>
}*@
@*<script>
    $(document).ready(function () {
        $(".statesSelect").select2();
        ajax:{
            processResults: function(data){
                return{
                    results: $.map, function(item){
                        return{
                            text: item.name860,
                            id: item.id
                        }
                    } 
            }
        }
            
    }

    });
    @Model.Task.Executor = $('#executor>option:selected').text()
</script>*@